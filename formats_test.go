package validate

import (
	"path/filepath"
	"testing"
)

type FormatTestGroup struct {
	Type  FormatType
	Tests []FormatTest
}

type FormatTest struct {
	Sample string
	Result bool
}

func getFormatTestGroups() []FormatTestGroup {
	return []FormatTestGroup{
		FormatTestGroup{
			FormatMAC, []FormatTest{
				{"3D:F2:C9:A6:B3:4F", true},
				{"3D-F2-C9-A6-B3:4F", false},
				{"123", false},
				{"", false},
				{"abacaba", false},
				{"00:25:96:FF:FE:12:34:56", true},
				{"0025:96FF:FE12:3456", false},
			},
		},
		FormatTestGroup{
			FormatIP, []FormatTest{
				{"", false},
				{"10.0.0.1", true},
				{"172.16.0.1", true},
				{"192.168.0.1", true},
				{"192.168.255.254", true},
				{"192.168.255.256", false},
				{"172.16.255.254", true},
				{"172.16.256.255", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652", true},
				{"2001:cdba:0:0:0:0:3257:9652", true},
				{"2001:cdba::3257:9652", true},
			},
		},
		FormatTestGroup{
			FormatIPv6, []FormatTest{
				{"10.0.0.1", false},
				{"172.16.0.1", false},
				{"192.168.0.1", false},
				{"192.168.255.254", false},
				{"192.168.255.256", false},
				{"172.16.255.254", false},
				{"172.16.256.255", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652", true},
				{"2001:cdba:0:0:0:0:3257:9652", true},
				{"2001:cdba::3257:9652", true},
			},
		},
		FormatTestGroup{
			FormatIPv4, []FormatTest{
				{"10.0.0.1", true},
				{"172.16.0.1", true},
				{"192.168.0.1", true},
				{"192.168.255.254", true},
				{"192.168.255.256", false},
				{"172.16.255.254", true},
				{"172.16.256.255", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652", false},
				{"2001:cdba:0:0:0:0:3257:9652", false},
				{"2001:cdba::3257:9652", false},
			},
		},
		FormatTestGroup{
			FormatCIDR, []FormatTest{
				{"10.0.0.0/0", true},
				{"10.0.0.1/8", true},
				{"172.16.0.1/16", true},
				{"192.168.0.1/24", true},
				{"192.168.255.254/24", true},
				{"192.168.255.254/48", false},
				{"192.168.255.256/24", false},
				{"172.16.255.254/16", true},
				{"172.16.256.255/16", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652/64", true},
				{"2001:cdba:0000:0000:0000:0000:3257:9652/256", false},
				{"2001:cdba:0:0:0:0:3257:9652/32", true},
				{"2001:cdba::3257:9652/16", true},
			},
		},
		FormatTestGroup{
			FormatCIDRv6, []FormatTest{
				{"10.0.0.0/0", false},
				{"10.0.0.1/8", false},
				{"172.16.0.1/16", false},
				{"192.168.0.1/24", false},
				{"192.168.255.254/24", false},
				{"192.168.255.254/48", false},
				{"192.168.255.256/24", false},
				{"172.16.255.254/16", false},
				{"172.16.256.255/16", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652/64", true},
				{"2001:cdba:0000:0000:0000:0000:3257:9652/256", false},
				{"2001:cdba:0:0:0:0:3257:9652/32", true},
				{"2001:cdba::3257:9652/16", true},
			},
		},
		FormatTestGroup{
			FormatCIDRv4, []FormatTest{
				{"10.0.0.0/0", true},
				{"10.0.0.1/8", true},
				{"172.16.0.1/16", true},
				{"192.168.0.1/24", true},
				{"192.168.255.254/24", true},
				{"192.168.255.254/48", false},
				{"192.168.255.256/24", false},
				{"172.16.255.254/16", true},
				{"172.16.256.255/16", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652/64", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652/256", false},
				{"2001:cdba:0:0:0:0:3257:9652/32", false},
				{"2001:cdba::3257:9652/16", false},
			},
		},
		FormatTestGroup{
			FormatSSN, []FormatTest{
				{"", false},
				{"00-90-8787", false},
				{"66690-76", false},
				{"191 60 2869", true},
				{"191-60-2869", true},
			},
		},
		FormatTestGroup{
			FormatLongitude, []FormatTest{
				{"", false},
				{"-180.000", true},
				{"180.1", false},
				{"+73.234", true},
				{"+382.3811", false},
				{"23.11111111", true},
			},
		},
		FormatTestGroup{
			FormatLatitude, []FormatTest{
				{"", false},
				{"-90.000", true},
				{"+90", true},
				{"47.1231231", true},
				{"+99.9", false},
				{"108", false},
			},
		},
		FormatTestGroup{
			FormatDataURI, []FormatTest{
				{"data:image/png;base64,TG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxpdC4=", true},
				{"data:text/plain;base64,Vml2YW11cyBmZXJtZW50dW0gc2VtcGVyIHBvcnRhLg==", true},
				{"image/gif;base64,U3VzcGVuZGlzc2UgbGVjdHVzIGxlbw==", false},
				{"data:image/gif;base64,MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuMPNS1Ufof9EW/M98FNw" +
					"UAKrwflsqVxaxQjBQnHQmiI7Vac40t8x7pIb8gLGV6wL7sBTJiPovJ0V7y7oc0Ye" +
					"rhKh0Rm4skP2z/jHwwZICgGzBvA0rH8xlhUiTvcwDCJ0kc+fh35hNt8srZQM4619" +
					"FTgB66Xmp4EtVyhpQV+t02g6NzK72oZI0vnAvqhpkxLeLiMCyrI416wHm5Tkukhx" +
					"QmcL2a6hNOyu0ixX/x2kSFXApEnVrJ+/IxGyfyw8kf4N2IZpW5nEP847lpfj0SZZ" +
					"Fwrd1mnfnDbYohX2zRptLy2ZUn06Qo9pkG5ntvFEPo9bfZeULtjYzIl6K8gJ2uGZ" + "HQIDAQAB", true},
				{"data:image/png;base64,12345", false},
				{"", false},
				{"data:text,:;base85,U3VzcGVuZGlzc2UgbGVjdHVzIGxlbw==", false},
			},
		},
		FormatTestGroup{
			FormatPrintableASCII, []FormatTest{
				{"", true},
				{"ｆｏｏbar", false},
				{"ｘｙｚ０９８", false},
				{"１２３456", false},
				{"ｶﾀｶﾅ", false},
				{"foobar", true},
				{"0987654321", true},
				{"test@example.com", true},
				{"1234abcDEF", true},
				{"newline\n", false},
				{"\x19test\x7F", false},
			},
		},
		FormatTestGroup{
			FormatASCII, []FormatTest{
				{"", true},
				{"ｆｏｏbar", false},
				{"ｘｙｚ０９８", false},
				{"１２３456", false},
				{"ｶﾀｶﾅ", false},
				{"foobar", true},
				{"0987654321", true},
				{"test@example.com", true},
				{"1234abcDEF", true},
				{"", true},
			},
		},
		FormatTestGroup{
			FormatUUID5, []FormatTest{
				{"", false},
				{"xxxa987Fbc9-4bed-3078-cf07-9141ba07c9f3", false},
				{"9c858901-8a57-4791-81Fe-4c455b099bc9", false},
				{"a987Fbc9-4bed-3078-cf07-9141ba07c9f3", false},
				{"987Fbc97-4bed-5078-af07-9141ba07c9f3", true},
				{"987Fbc97-4bed-5078-9f07-9141ba07c9f3", true},
			},
		},
		FormatTestGroup{
			FormatUUID4, []FormatTest{
				{"", false},
				{"xxxa987fbc9-4bed-3078-cf07-9141ba07c9F3", false},
				{"a987fbc9-4bed-5078-af07-9141ba07c9F3", false},
				{"934859", false},
				{"57b73598-8764-4ad0-a76A-679bb6640eb1", true},
				{"625e63f3-58f5-40b7-83a1-a72ad31acFfb", true},
			},
		},
		FormatTestGroup{
			FormatUUID3, []FormatTest{
				{"", false},
				{"412452646", false},
				{"xxxa987fbc9-4bed-3078-cf07-9141ba07c9F3", false},
				{"a987fbc9-4bed-4078-8f07-9141ba07c9F3", false},
				{"a987fbc9-4bed-3078-cf07-9141ba07c9F3", true},
			},
		},
		FormatTestGroup{
			FormatUUID, []FormatTest{
				{"", false},
				{"xxxa987Fbc9-4bed-3078-cf07-9141ba07c9f3", false},
				{"a987Fbc9-4bed-3078-cf07-9141ba07c9f3xxx", false},
				{"a987Fbc94bed3078cf079141ba07c9f3", false},
				{"934859", false},
				{"987fbc9-4bed-3078-cf07a-9141ba07c9F3", false},
				{"aaaaaaaa-1111-1111-aaaG-111111111111", false},
				{"a987Fbc9-4bed-3078-cf07-9141ba07c9f3", true},
			},
		},
		FormatTestGroup{
			FormatISBN, []FormatTest{
				{"", false},
				{"foo", false},
				{"3836221195", true},
				{"1-61729-085-8", true},
				{"3 423 21412 0", true},
				{"3 401 01319 X", true},
				{"9784873113685", true},
				{"978-4-87311-368-5", true},
				{"978 3401013190", true},
				{"978-3-8362-2119-1", true},
			},
		},
		FormatTestGroup{
			FormatISBN13, []FormatTest{
				{"", false},
				{"foo", false},
				{"3-8362-2119-5", false},
				{"01234567890ab", false},
				{"978 3 8362 2119 0", false},
				{"9784873113685", true},
				{"978-4-87311-368-5", true},
				{"978 3401013190", true},
				{"978-3-8362-2119-1", true},
			},
		},
		FormatTestGroup{
			FormatISBN10, []FormatTest{
				{"", false},
				{"foo", false},
				{"3423214121", false},
				{"978-3836221191", false},
				{"3-423-21412-1", false},
				{"3 423 21412 1", false},
				{"3836221195", true},
				{"1-61729-085-8", true},
				{"3 423 21412 0", true},
				{"3 401 01319 X", true},
			},
		},
		FormatTestGroup{
			FormatBase64, []FormatTest{
				{"dW5pY29ybg==", true},
				{"dGhpIGlzIGEgdGVzdCBiYXNlNjQ=", true},
				{"", false},
				{"dW5pY29ybg== foo bar", false},
			},
		},
		FormatTestGroup{
			FormatBase64URL, []FormatTest{
				// empty string, although a valid base64 string, should fail
				{"", false},
				// invalid length
				{"a", false},
				// base64 with padding
				{"Zg==", true},
				{"Zm8=", true},
				// base64 without padding
				{"Zm9v", true},
				{"Zg", false},
				{"Zm8", false},
				// base64 URL safe encoding with invalid, special characters '+' and '/'
				{"FPucA9l+", false},
				{"FPucA/lz", false},
				// base64 URL safe encoding with valid, special characters '-' and '_'
				{"FPucA9l-", true},
				{"FPucA_lz", true},
				// non base64 characters
				{"@mc=", false},
				{"Zm 9", false},
			},
		},
		FormatTestGroup{
			FormatFile, []FormatTest{
				// empty path
				{"", false},
				// regular file
				{filepath.Join("testdata", "a.go"), true},
				// missing file
				{filepath.Join("testdata", "no.go"), false},
				// directory, not a file
				{"testdata", false},
			},
		},
		FormatTestGroup{
			FormatDir, []FormatTest{
				// existing dir
				{"testdata", true},
				// existing self dir
				{".", true},
				// existing parent dir
				{"..", true},
				// empty dir
				{"", false},
				// missing dir
				{"non_existing_testdata", false},
				// a file not a directory
				{filepath.Join("testdata", "a.go"), false},
			},
		},
		FormatTestGroup{
			FormatEthereumAddress, []FormatTest{
				{"", false},
				{"0x02F9AE5f22EA3fA88F05780B30385bEC", false},
				{"123f681646d4a755815f9cb19e1acc8565a0c2ac", false},
				{"0x02F9AE5f22EA3fA88F05780B30385bECFacbf130", true},
				{"0x123f681646d4a755815f9cb19e1acc8565a0c2ac", true},
			},
		},
		FormatTestGroup{
			FormatBitcoinAddress, []FormatTest{
				{"", false},
				{"x", false},
				{"0x02F9AE5f22EA3fA88F05780B30385bEC", false},
				{"1A1zP1ePQGefi2DMPTifTL5SLmv7DivfNa", false},
				{"1P9RQEr2XeE3PEb44ZE35sfZRRW1JH8Uqx", false},
				{"3P14159I73E4gFr7JterCCQh9QjiTjiZrG", false},
				{"3P141597f3E4gFr7JterCCQh9QjiTjiZrG", false},
				{"37qgekLpCCHrQuSjvX3fs496FWTGsHFHizjJAs6NPcR47aefnnCWECAhHV6E3g4YN7u7Yuwod5Y", false},
				{"dzb7VV1Ui55BARxv7ATxAtCUeJsANKovDGWFVgpTbhq9gvPqP3yv", false},
				{"MuNu7ZAEDFiHthiunm7dPjwKqrVNCM3mAz6rP9zFveQu14YA8CxExSJTHcVP9DErn6u84E6Ej7S", false},
				{"rPpQpYknyNQ5AEHuY6H8ijJJrYc2nDKKk9jjmKEXsWzyAQcFGpDLU2Zvsmoi8JLR7hAwoy3RQWf", false},
				{"4Uc3FmN6NQ6zLBK5QQBXRBUREaaHwCZYsGCueHauuDmJpZKn6jkEskMB2Zi2CNgtb5r6epWEFfUJq", false},
				{"7aQgR5DFQ25vyXmqZAWmnVCjL3PkBcdVkBUpjrjMTcghHx3E8wb", false},
				{"17QpPprjeg69fW1DV8DcYYCKvWjYhXvWkov6MJ1iTTvMFj6weAqW7wybZeH57WTNxXVCRH4veVs", false},
				{"KxuACDviz8Xvpn1xAh9MfopySZNuyajYMZWz16Dv2mHHryznWUp3", false},
				{"7nK3GSmqdXJQtdohvGfJ7KsSmn3TmGqExug49583bDAL91pVSGq5xS9SHoAYL3Wv3ijKTit65th", false},
				{"cTivdBmq7bay3RFGEBBuNfMh2P1pDCgRYN2Wbxmgwr4ki3jNUL2va", false},
				{"gjMV4vjNjyMrna4fsAr8bWxAbwtmMUBXJS3zL4NJt5qjozpbQLmAfK1uA3CquSqsZQMpoD1g2nk", false},
				{"emXm1naBMoVzPjbk7xpeTVMFy4oDEe25UmoyGgKEB1gGWsK8kRGs", false},
				{"7VThQnNRj1o3Zyvc7XHPRrjDf8j2oivPTeDXnRPYWeYGE4pXeRJDZgf28ppti5hsHWXS2GSobdqyo", false},
				{"1G9u6oCVCPh2o8m3t55ACiYvG1y5BHewUkDSdiQarDcYXXhFHYdzMdYfUAhfxn5vNZBwpgUNpso", false},
				{"31QQ7ZMLkScDiB4VyZjuptr7AEc9j1SjstF7pRoLhHTGkW4Q2y9XELobQmhhWxeRvqcukGd1XCq", false},
				{"DHqKSnpxa8ZdQyH8keAhvLTrfkyBMQxqngcQA5N8LQ9KVt25kmGN", false},
				{"2LUHcJPbwLCy9GLH1qXmfmAwvadWw4bp4PCpDfduLqV17s6iDcy1imUwhQJhAoNoN1XNmweiJP4i", false},
				{"7USRzBXAnmck8fX9HmW7RAb4qt92VFX6soCnts9s74wxm4gguVhtG5of8fZGbNPJA83irHVY6bCos", false},
				{"1DGezo7BfVebZxAbNT3XGujdeHyNNBF3vnficYoTSp4PfK2QaML9bHzAMxke3wdKdHYWmsMTJVu", false},
				{"2D12DqDZKwCxxkzs1ZATJWvgJGhQ4cFi3WrizQ5zLAyhN5HxuAJ1yMYaJp8GuYsTLLxTAz6otCfb", false},
				{"8AFJzuTujXjw1Z6M3fWhQ1ujDW7zsV4ePeVjVo7D1egERqSW9nZ", false},
				{"163Q17qLbTCue8YY3AvjpUhotuaodLm2uqMhpYirsKjVqnxJRWTEoywMVY3NbBAHuhAJ2cF9GAZ", false},
				{"2MnmgiRH4eGLyLc9eAqStzk7dFgBjFtUCtu", false},
				{"461QQ2sYWxU7H2PV4oBwJGNch8XVTYYbZxU", false},
				{"2UCtv53VttmQYkVU4VMtXB31REvQg4ABzs41AEKZ8UcB7DAfVzdkV9JDErwGwyj5AUHLkmgZeobs", false},
				{"cSNjAsnhgtiFMi6MtfvgscMB2Cbhn2v1FUYfviJ1CdjfidvmeW6mn", false},
				{"gmsow2Y6EWAFDFE1CE4Hd3Tpu2BvfmBfG1SXsuRARbnt1WjkZnFh1qGTiptWWbjsq2Q6qvpgJVj", false},
				{"nksUKSkzS76v8EsSgozXGMoQFiCoCHzCVajFKAXqzK5on9ZJYVHMD5CKwgmX3S3c7M1U3xabUny", false},
				{"L3favK1UzFGgdzYBF2oBT5tbayCo4vtVBLJhg2iYuMeePxWG8SQc", false},
				{"7VxLxGGtYT6N99GdEfi6xz56xdQ8nP2dG1CavuXx7Rf2PrvNMTBNevjkfgs9JmkcGm6EXpj8ipyPZ ", false},
				{"2mbZwFXF6cxShaCo2czTRB62WTx9LxhTtpP", false},
				{"dB7cwYdcPSgiyAwKWL3JwCVwSk6epU2txw", false},
				{"HPhFUhUAh8ZQQisH8QQWafAxtQYju3SFTX", false},
				{"4ctAH6AkHzq5ioiM1m9T3E2hiYEev5mTsB", false},
				{"31uEbMgunupShBVTewXjtqbBv5MndwfXhb", false},
				{"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W", false},
				{"Hn1uFi4dNexWrqARpjMqgT6cX1UsNPuV3cHdGg9ExyXw8HTKadbktRDtdeVmY3M1BxJStiL4vjJ", false},
				{"Sq3fDbvutABmnAHHExJDgPLQn44KnNC7UsXuT7KZecpaYDMU9Txs", false},
				{"6TqWyrqdgUEYDQU1aChMuFMMEimHX44qHFzCUgGfqxGgZNMUVWJ", false},
				{"giqJo7oWqFxNKWyrgcBxAVHXnjJ1t6cGoEffce5Y1y7u649Noj5wJ4mmiUAKEVVrYAGg2KPB3Y4", false},
				{"cNzHY5e8vcmM3QVJUcjCyiKMYfeYvyueq5qCMV3kqcySoLyGLYUK", false},
				{"37uTe568EYc9WLoHEd9jXEvUiWbq5LFLscNyqvAzLU5vBArUJA6eydkLmnMwJDjkL5kXc2VK7ig", false},
				{"EsYbG4tWWWY45G31nox838qNdzksbPySWc", false},
				{"nbuzhfwMoNzA3PaFnyLcRxE9bTJPDkjZ6Rf6Y6o2ckXZfzZzXBT", false},
				{"cQN9PoxZeCWK1x56xnz6QYAsvR11XAce3Ehp3gMUdfSQ53Y2mPzx", false},
				{"1Gm3N3rkef6iMbx4voBzaxtXcmmiMTqZPhcuAepRzYUJQW4qRpEnHvMojzof42hjFRf8PE2jPde", false},
				{"2TAq2tuN6x6m233bpT7yqdYQPELdTDJn1eU", false},
				{"ntEtnnGhqPii4joABvBtSEJG6BxjT2tUZqE8PcVYgk3RHpgxgHDCQxNbLJf7ardf1dDk2oCQ7Cf", false},
				{"Ky1YjoZNgQ196HJV3HpdkecfhRBmRZdMJk89Hi5KGfpfPwS2bUbfd", false},
				{"2A1q1YsMZowabbvta7kTy2Fd6qN4r5ZCeG3qLpvZBMzCixMUdkN2Y4dHB1wPsZAeVXUGD83MfRED", false},
				{"1AGNa15ZQXAZUgFiqJ2i7Z2DPU2J6hW62i", true},
				{"1Ax4gZtb7gAit2TivwejZHYtNNLT18PUXJ", true},
				{"1C5bSj1iEGUgSTbziymG7Cn18ENQuT36vv", true},
				{"1Gqk4Tv79P91Cc1STQtU3s1W6277M2CVWu", true},
				{"1JwMWBVLtiqtscbaRHai4pqHokhFCbtoB4", true},
				{"19dcawoKcZdQz365WpXWMhX6QCUpR9SY4r", true},
				{"13p1ijLwsnrcuyqcTvJXkq2ASdXqcnEBLE", true},
				{"1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2", true},
				{"3P14159f73E4gFr7JterCCQh9QjiTjiZrG", true},
				{"3CMNFxN1oHBc4R1EpboAL5yzHGgE611Xou", true},
				{"3QjYXhTkvuj8qPaXHTTWb5wjXhdsLAAWVy", true},
				{"3AnNxabYGoTxYiTEZwFEnerUoeFXK2Zoks", true},
				{"33vt8ViH5jsr115AGkW6cEmEz9MpvJSwDk", true},
				{"3QCzvfL4ZRvmJFiWWBVwxfdaNBT8EtxB5y", true},
				{"37Sp6Rv3y4kVd1nQ1JV5pfqXccHNyZm1x3", true},
				{"3ALJH9Y951VCGcVZYAdpA3KchoP9McEj1G", true},
				{"12KYrjTdVGjFMtaxERSk3gphreJ5US8aUP", true},
				{"12QeMLzSrB8XH8FvEzPMVoRxVAzTr5XM2y", true},
				{"1oNLrsHnBcR6dpaBpwz3LSwutbUNkNSjs", true},
				{"1SQHtwR5oJRKLfiWQ2APsAd9miUc4k2ez", true},
				{"116CGDLddrZhMrTwhCVJXtXQpxygTT1kHd", true},
				{"3NJZLcZEEYBpxYEUGewU4knsQRn1WM5Fkt", true},
			},
		},
		FormatTestGroup{
			FormatBitcoinBech32Address, []FormatTest{
				{"", false},
				{"bc1rw5uspcuh", false},
				{"bc1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t5", false},
				{"BC13W508D6QEJXTDG4Y5R3ZARVARY0C5XW7KN40WF2", false},
				{"qw508d6qejxtdg4y5r3zarvary0c5xw7kg3g4ty", false},
				{"bc1rw5uspcuh", false},
				{"bc10w508d6qejxtdg4y5r3zarvary0c5xw7kw508d6qejxtdg4y5r3zarvary0c5xw7kw5rljs90", false},
				{"BC1QW508d6QEJxTDG4y5R3ZArVARY0C5XW7KV8F3T4", false},
				{"BC1QR508D6QEJXTDG4Y5R3ZARVARYV98GJ9P", false},
				{"bc1qw508d6qejxtdg4y5r3zarvary0c5xw7kv8f3t5", false},
				{"bc10w508d6qejxtdg4y5r3zarvary0c5xw7kw508d6qejxtdg4y5r3zarvary0c5xw7kw5rljs90", false},
				{"bc1pw508d6qejxtdg4y5r3zarqfsj6c3", false},
				{"bc1zw508d6qejxtdg4y5r3zarvaryvqyzf3du", false},
				{"bc1gmk9yu", false},
				{"bc1qrp33g0q5c5txsp9arysrx4k6zdkfs4nce4xj0gdcccefvpysxf3pjxtptv", false},
				{"BC1QW508D6QEJXTDG4Y5R3ZARVARY0C5XW7KV8F3T4", true},
				{"bc1pw508d6qejxtdg4y5r3zarvary0c5xw7kw508d6qejxtdg4y5r3zarvary0c5xw7k7grplx", true},
				{"bc1qrp33g0q5c5txsp9arysrx4k6zdkfs4nce4xj0gdcccefvpysxf3qccfmv3", true},
				{"BC1SW50QA3JX3S", true},
				{"bc1zw508d6qejxtdg4y5r3zarvaryvg6kdaj", true},
			},
		},
		FormatTestGroup{
			FormatUrnRFC2141, []FormatTest{
				{"urn:a:b", true},
				{"urn:a::", true},
				{"urn:a:-", true},
				{"URN:simple:simple", true},
				{"urn:urna:simple", true},
				{"urn:burnout:nss", true},
				{"urn:burn:nss", true},
				{"urn:urnurnurn:x", true},
				{"urn:abcdefghilmnopqrstuvzabcdefghilm:x", true},
				{"URN:123:x", true},
				{"URN:abcd-:x", true},
				{"URN:abcd-abcd:x", true},
				{"urn:urnx:urn", true},
				{"urn:ciao:a:b:c", true},
				{"urn:aaa:x:y:", true},
				{"urn:ciao:-", true},
				{"urn:colon:::::nss", true},
				{"urn:ciao:@!=%2C(xyz)+a,b.*@g=$_'", true},
				{"URN:hexes:%25", true},
				{"URN:x:abc%1Dz%2F%3az", true},
				{"URN:foo:a123,456", true},
				{"urn:foo:a123,456", true},
				{"urn:FOO:a123,456", true},
				{"urn:foo:A123,456", true},
				{"urn:foo:a123%2C456", true},
				{"URN:FOO:a123%2c456", true},
				{"URN:FOO:ABC%FFabc123%2c456", true},
				{"URN:FOO:ABC%FFabc123%2C456%9A", true},
				{"urn:ietf:params:scim:schemas:core:2.0:User", true},
				{"urn:ietf:params:scim:schemas:extension:enterprise:2.0:User:meta.lastModified", true},
				{"URN:-xxx:x", false},
				{"urn::colon:nss", false},
				{"urn:abcdefghilmnopqrstuvzabcdefghilmn:specificstring", false},
				{"URN:a!?:x", false},
				{"URN:#,:x", false},
				{"urn:urn:NSS", false},
				{"urn:URN:NSS", false},
				{"urn:white space:NSS", false},
				{"urn:concat:no spaces", false},
				{"urn:a:%", false},
				{"urn:", false},
			},
		},
		FormatTestGroup{
			FormatURL, []FormatTest{
				{"http://foo.bar#com", true},
				{"http://foobar.com", true},
				{"https://foobar.com", true},
				{"foobar.com", false},
				{"http://foobar.coffee/", true},
				{"http://foobar.中文网/", true},
				{"http://foobar.org/", true},
				{"http://foobar.org:8080/", true},
				{"ftp://foobar.ru/", true},
				{"http://user:pass@www.foobar.com/", true},
				{"http://127.0.0.1/", true},
				{"http://duckduckgo.com/?q=%2F", true},
				{"http://localhost:3000/", true},
				{"http://foobar.com/?foo=bar#baz=qux", true},
				{"http://foobar.com?foo=bar", true},
				{"http://www.xn--froschgrn-x9a.net/", true},
				{"", false},
				{"xyz://foobar.com", true},
				{"invalid.", false},
				{".com", false},
				{"rtmp://foobar.com", true},
				{"http://www.foo_bar.com/", true},
				{"http://localhost:3000/", true},
				{"http://foobar.com/#baz", true},
				{"http://foobar.com#baz=qux", true},
				{"http://foobar.com/t$-_.+!*\\'(),", true},
				{"http://www.foobar.com/~foobar", true},
				{"http://www.-foobar.com/", true},
				{"http://www.foo---bar.com/", true},
				{"mailto:someone@example.com", true},
				{"irc://irc.server.org/channel", true},
				{"irc://#channel@network", true},
				{"/abs/test/dir", false},
				{"./rel/test/dir", false},
			},
		},
		FormatTestGroup{
			FormatURI, []FormatTest{
				{"http://foo.bar#com", true},
				{"http://foobar.com", true},
				{"https://foobar.com", true},
				{"foobar.com", false},
				{"http://foobar.coffee/", true},
				{"http://foobar.中文网/", true},
				{"http://foobar.org/", true},
				{"http://foobar.org:8080/", true},
				{"ftp://foobar.ru/", true},
				{"http://user:pass@www.foobar.com/", true},
				{"http://127.0.0.1/", true},
				{"http://duckduckgo.com/?q=%2F", true},
				{"http://localhost:3000/", true},
				{"http://foobar.com/?foo=bar#baz=qux", true},
				{"http://foobar.com?foo=bar", true},
				{"http://www.xn--froschgrn-x9a.net/", true},
				{"", false},
				{"xyz://foobar.com", true},
				{"invalid.", false},
				{".com", false},
				{"rtmp://foobar.com", true},
				{"http://www.foo_bar.com/", true},
				{"http://localhost:3000/", true},
				{"http://foobar.com#baz=qux", true},
				{"http://foobar.com/t$-_.+!*\\'(),", true},
				{"http://www.foobar.com/~foobar", true},
				{"http://www.-foobar.com/", true},
				{"http://www.foo---bar.com/", true},
				{"mailto:someone@example.com", true},
				{"irc://irc.server.org/channel", true},
				{"irc://#channel@network", true},
				{"/abs/test/dir", true},
				{"./rel/test/dir", false},
			},
		},
		FormatTestGroup{
			FormatHSLA, []FormatTest{
				{"hsla(360,100%,100%,1)", true},
				{"hsla(360,100%,100%,0.5)", true},
				{"hsla(0,0%,0%, 0)", true},
				{"hsl(361,100%,50%,1)", false},
				{"hsl(361,100%,50%)", false},
				{"hsla(361,100%,50%)", false},
				{"hsla(360,101%,50%)", false},
				{"hsla(360,100%,101%)", false},
			},
		},
		FormatTestGroup{
			FormatHSL, []FormatTest{
				{"hsl(360,100%,50%)", true},
				{"hsl(0,0%,0%)", true},
				{"hsl(361,100%,50%)", false},
				{"hsl(361,101%,50%)", false},
				{"hsl(361,100%,101%)", false},
				{"hsl(-10,100%,100%)", false},
			},
		},
		FormatTestGroup{
			FormatRGBA, []FormatTest{
				{"rgba(0,31,255,0.5)", true},
				{"rgba(0,31,255,0.12)", true},
				{"rgba(12%,55%,100%,0.12)", true},
				{"rgba( 0,  31, 255, 0.5)", true},
				{"rgba(12%,55,100%,0.12)", false},
				{"rgb(0,  31, 255)", false},
				{"rgb(1,349,275,0.5)", false},
				{"rgb(01,31,255,0.5)", false},
			},
		},
		FormatTestGroup{
			FormatRGB, []FormatTest{
				{"rgb(0,31,255)", true},
				{"rgb(0,  31, 255)", true},
				{"rgb(10%,  50%, 100%)", true},
				{"rgb(10%,  50%, 55)", false},
				{"rgb(1,349,275)", false},
				{"rgb(01,31,255)", false},
				{"rgba(0,31,255)", false},
			},
		},
		FormatTestGroup{
			FormatEmail, []FormatTest{
				{"test@mail.com", true},
				{"Dörte@Sörensen.example.com", true},
				{"θσερ@εχαμπλε.ψομ", true},
				{"юзер@екзампл.ком", true},
				{"उपयोगकर्ता@उदाहरण.कॉम", true},
				{"用户@例子.广告", true},
				{"mail@domain_with_underscores.org", false},
				{"", false},
				{"test@email", false},
				{"test@email.", false},
				{"@email.com", false},
				{`"test test"@email.com`, true},
				{`"@email.com`, false},
			},
		},
		FormatTestGroup{
			FormatHEXColor, []FormatTest{
				{"#fff", true},
				{"#c2c2c2", true},
				{"fff", false},
				{"fffFF", false},
				{"", false},
			},
		},
		FormatTestGroup{
			FormatHexadecimal, []FormatTest{
				{"ff0044", true},
				{"abcdefg", false},
			},
		},
		FormatTestGroup{
			FormatNumber, []FormatTest{
				{"1", true},
				{"+1", true},
				{"-1", true},
				{"1.12", true},
				{"+1.12", true},
				{"-1.12", true},
				{"1.", false},
				{"1.o", false},
				{"", false},
			},
		},
		FormatTestGroup{
			FormatNumeric, []FormatTest{
				{"1", true},
				{"+1", false},
				{"-1", false},
				{"1.12", false},
				{"+1.12", false},
				{"-1.12", false},
				{"1.", false},
				{"1.o", false},
				{"", false},
			},
		},
		FormatTestGroup{
			FormatAlnum, []FormatTest{
				{"abcd123", true},
				{"abc!23", false},
				{"", false},
			},
		},
		FormatTestGroup{
			FormatAlpha, []FormatTest{
				{"abcd", true},
				{"abc®", false},
				{"abc÷", false},
				{"abc1", false},
				{"this is a test string", false},
				{"", false},
			},
		},
		FormatTestGroup{
			FormatAlnumUnicode, []FormatTest{
				{"", false},
				{"abc", true},
				{"this is a test string", false},
				{"这是一个测试字符串", true},
				{"\u0031\u0032\u0033", true}, // unicode 5
				{"123", true},
				{"<>@;.-=", false},
				{"ひらがな・カタカナ、．漢字", false},
				{"あいうえおfoobar", true},
				{"test＠example.com", false},
				{"1234abcDE", true},
				{"ｶﾀｶﾅ", true},
			},
		},
		FormatTestGroup{
			FormatAlphaUnicode, []FormatTest{
				{"", false},
				{"abc", true},
				{"this is a test string", false},
				{"这是一个测试字符串", true},
				{"123", false},
				{"<>@;.-=", false},
				{"ひらがな・カタカナ、．漢字", false},
				{"あいうえおfoobar", true},
				{"test＠example.com", false},
				{"1234abcDE", false},
				{"ｶﾀｶﾅ", true},
			},
		},
		FormatTestGroup{
			FormatHostnameRFC952, []FormatTest{
				{"test.example.com", true},
				{"example.com", true},
				{"example24.com", true},
				{"test.example24.com", true},
				{"test24.example24.com", true},
				{"example", true},
				{"EXAMPLE", true},
				{"1.foo.com", false},
				{"test.example.com.", false},
				{"example.com.", false},
				{"example24.com.", false},
				{"test.example24.com.", false},
				{"test24.example24.com.", false},
				{"example.", false},
				{"192.168.0.1", false},
				{"email@example.com", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652", false},
				{"2001:cdba:0:0:0:0:3257:9652", false},
				{"2001:cdba::3257:9652", false},
			},
		},
		FormatTestGroup{
			FormatHostnameRFC1123, []FormatTest{
				{"test.example.com", true},
				{"example.com", true},
				{"example24.com", true},
				{"test.example24.com", true},
				{"test24.example24.com", true},
				{"example", true},
				{"1.foo.com", true},
				{"test.example.com.", false},
				{"example.com.", false},
				{"example24.com.", false},
				{"test.example24.com.", false},
				{"test24.example24.com.", false},
				{"example.", false},
				{"192.168.0.1", true},
				{"email@example.com", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652", false},
				{"2001:cdba:0:0:0:0:3257:9652", false},
				{"2001:cdba::3257:9652", false},
			},
		},
		FormatTestGroup{
			FormatFQDN, []FormatTest{
				{"test.example.com", true},
				{"example.com", true},
				{"example24.com", true},
				{"test.example24.com", true},
				{"test24.example24.com", true},
				{"test.example.com.", true},
				{"example.com.", true},
				{"example24.com.", true},
				{"test.example24.com.", true},
				{"test24.example24.com.", true},
				{"test24.example24.com..", false},
				{"example", false},
				{"192.168.0.1", false},
				{"email@example.com", false},
				{"2001:cdba:0000:0000:0000:0000:3257:9652", false},
				{"2001:cdba:0:0:0:0:3257:9652", false},
				{"2001:cdba::3257:9652", false},
				{"", false},
			},
		},
		FormatTestGroup{
			FormatURLEncoded, []FormatTest{
				{"%20", true},
				{"%af", true},
				{"%ff", true},
				{"<%az", false},
				{"%test%", false},
				{"a%b", false},
				{"1%2", false},
				{"%%a%%", false},
			},
		},
		FormatTestGroup{
			FormatPostcode, []FormatTest{
				{"PO32 6QN", true},
				{"PO30 1JQ", true},
				{"WC2H", false},
				{"WC2H 7LTa", false},
			},
		},
	}
}

func Test(t *testing.T) {
	groups := getFormatTestGroups()
	formatTypeMap := getFormatTypeMap()

	for _, group := range groups {
		for _, test := range group.Tests {
			if result := formatTypeMap[group.Type](test.Sample); result != test.Result {
				t.Errorf("%v format validator does not validate sample \"%v\", exected %v.", group.Type, test.Sample, test.Result)
			}
		}
	}
}
